:_mod-docs-content-type: ASSEMBLY
include::_attributes/common-attributes.adoc[]
[id="using-rh-entitlements-pipelines"]
= Using Red Hat entitlements in pipelines
:context: using-rh-entitlements-pipelines

toc::[]

If you have {op-system-base-full} entitlements, you can use these entitlements to build container images in your pipelines.

The Insight Operator automatically manages your entitlements after you import them into this operator from Simple Common Access (SCA). This operator provides a secret named `etc-pki-entitlement` in the `openshift-config-managed` namespace.

You can use Red Hat entitlements in your pipelines in one of the following two ways:

* Manually copy the secret into the namespace of the pipeline. This method is least complex if you have a limited number of pipeline namespaces.

* Use the Shared Resources Container Storage Interface (CSI) Driver Operator to share the secret between namespaces automatically.

== Prerequisites

* You logged on to your {OCP} cluster using the `oc` command line tool.

* You enabled the Insights Operator feature on your {OCP} cluster. If you want to use the Shared Resources CSI Driver operator to share the secret between namespaces, you must also enable the Shared Resources CSI driver. For information about enabling features, including the Insights Operator and Shared Resources CSI Driver, see link:https://docs.openshift.com/container-platform/latest/nodes/clusters/nodes-cluster-enabling-features.html[Enabling features using feature gates].
+

+
[NOTE]
====
After you enable the Insights Operator, you must wait for some time to ensure that the cluster updates all the nodes with this operator. You can monitor the status of all nodes by entering the following command:

[source,terminal]
----
$ oc get nodes -w
----

To verify that the Insights Operator is active, check that the `insights-operator` pod is running in the `openshift-insights` namespace by entering the following command:

[source,terminal]
----
$ oc get pods -n openshift-insights
----
====

* You configured the importing of your Red Hat entitlements into the Insights Operator. For information about importing the entitlements, see link:https://docs.openshift.com/container-platform/latest/support/remote_health_monitoring/insights-operator-simple-access.html[Importing simple content access entitlements with Insights Operator].
+
[NOTE]
====
To verify that the Insights Operator made your entitlements available, is active, check that the `etc-pki-entitlement` secret is present in the `openshift-config-managed` namespace by entering the following command:

[source,terminal]
----
$ oc get secret etc-pki-entitlement -n openshift-config-managed
----
====

include::modules/op-entitlements-manual-copying.adoc[leveloffset=+1]
include::modules/op-entitlements-shared-csi-driver.adoc[leveloffset=+1]


[role="_additional-resources"]
[id="additional-resources_{context}"]
== Additional resources

* link:https://access.redhat.com/articles/simple-content-access[Simple content access]
* link:https://docs.openshift.com/container-platform/4.14/support/remote_health_monitoring/using-insights-operator.html[Using Insights Operator]
* link:https://docs.openshift.com/container-platform/latest/support/remote_health_monitoring/insights-operator-simple-access.html[Importing simple content access entitlements with Insights Operator]
* https://docs.openshift.com/container-platform/4.14/storage/container_storage_interface/ephemeral-storage-shared-resource-csi-driver-operator.html[Shared Resource CSI Driver Operator]
* xref:../install_config/customizing-configurations-in-the-tektonconfig-cr.adoc#op-changing-default-service-account_customizing-configurations-in-the-tektonconfig-cr[Changing the default service account for OpenShift Pipelines]
