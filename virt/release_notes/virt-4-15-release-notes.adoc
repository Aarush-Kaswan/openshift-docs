:_mod-docs-content-type: ASSEMBLY
[id="virt-4-15-release-notes"]
= {VirtProductName} release notes
include::_attributes/common-attributes.adoc[]
:context: virt-4-15-release-notes

toc::[]

include::modules/making-open-source-more-inclusive.adoc[leveloffset=+1]

[id="virt-doc-feedback"]
== Providing documentation feedback

To report an error or to improve our documentation, log in to your link:https://issues.redhat.com[Red Hat Jira account] and submit a link:https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12323181&issuetype=1&components=12333768&priority=10200&summary=%5BDoc%5D&customfield_12316142[Jira issue].

[id="virt-about-virt"]
== About Red Hat {VirtProductName}

With Red Hat {VirtProductName}, you can bring traditional virtual machines (VMs) into {product-title} and run them alongside containers. In {VirtProductName}, VMs are native Kubernetes objects that you can manage by using the {product-title} web console or the command line.

{VirtProductName} is represented by the image:virt-icon.png[{VirtProductName},40,40] icon.

You can use {VirtProductName} with either the xref:../../networking/ovn_kubernetes_network_provider/about-ovn-kubernetes.adoc#about-ovn-kubernetes[OVN-Kubernetes] or the xref:../../networking/openshift_sdn/about-openshift-sdn.adoc#about-openshift-sdn[OpenShiftSDN] default Container Network Interface (CNI) network provider.

Learn more about xref:../../virt/about_virt/about-virt.adoc#about-virt[what you can do with {VirtProductName}].

Learn more about xref:../../virt/about_virt/virt-architecture.adoc#virt-architecture[{VirtProductName} architecture and deployments].

xref:../../virt/install/preparing-cluster-for-virt.adoc#preparing-cluster-for-virt[Prepare your cluster] for {VirtProductName}.

include::modules/virt-supported-cluster-version.adoc[leveloffset=+2]


[id="virt-guest-os"]
=== Supported guest operating systems
To view the supported guest operating systems for {VirtProductName}, see link:https://access.redhat.com/articles/973163#ocpvirt[Certified Guest Operating Systems in Red Hat OpenStack Platform, Red Hat Virtualization, OpenShift Virtualization and Red Hat Enterprise Linux with KVM].

//Ensure platform passes Windows Server Virtualization Validation Program. Otherwise, comment out the section below.
[id="virt-svvp-certification"]
=== Microsoft Windows SVVP certification

//CNV-31842 SVVP 4.15 Release Note: NEW
//NOTE: This is a recurring release note. Modify the existing note text below if recommended by QE.
{VirtProductName} is certified in Microsoft's Windows Server Virtualization Validation Program (SVVP) to run Windows Server workloads.

The SVVP certification applies to:

* Red Hat Enterprise Linux CoreOS workers. In the Microsoft SVVP Catalog, they are named __Red Hat OpenShift Container Platform 4 on RHEL CoreOS 9__.
* Intel and AMD CPUs.

[id="virt-quick-starts"]
== Quick starts

Quick start tours are available for several {VirtProductName} features. To view the tours, click the *Help* icon *?* in the menu bar on the header of the {product-title} web console and then select *Quick Starts*. You can filter the available tours by entering the keyword `virtualization` in the *Filter* field.


[id="virt-4-15-new"]
== New and changed features

This release adds new features and enhancements related to the following components and concepts:

[id="virt-4-15-installation-update"]
=== Installation and update

//CNV-34757: Guest OS console logs are collected by default

//CNV-34680: Metrics update. This is probably related to the note in the Deprecated features section.

[id="virt-4-15-infrastructure"]
=== Infrastructure

//CNV-29987: Move instancetype API from v1alpha2 to v1beta1. As of 01/03/2024, this is an In Progress TP RN for 4.14 (CNV-21920).

//CNV-31433: virtio-serial channel for SAP

[id="virt-4-15-virtualization"]
=== Virtualization

//CNV-29983: Free page reporting
* Free page reporting is enabled by default.

//CNV-28880: KSM configuration
* You can configure {VirtProductName} to xref:../../virt/virtual_machines/advanced_vm_management/virt-activating-ksm.adoc#virt-activating-ksm[activate kernel samepage merging (KSM)] when a node is overloaded.

[id="virt-4-15-networking"]
=== Networking

//CNV-30170: NetworkPolicies filtering using IP blocks with OVN-Kubernetes

//CNV-30164: NIC hot plug feature is now GA. This was TP for 4.14. Moved the release note from the TP section to here.
* You can xref:../../virt/vm_networking/virt-hot-plugging-network-interfaces.adoc#virt-hot-plugging-network-interfaces[hot plug a bridge network interface] to a running virtual machine (VM). Hot plugging and hot unplugging is supported only for VMs created with {VirtProductName} 4.14 or later.

//CNV-30167: SR-IOV NIC hot plug

//CNV-13680: Connecting OVN-Kubernetes to underlying physical networks. Remove known issue BZ-1885605 after adding this note.

//CNV-30296: Running DPDK workloads on SR-IOV is now GA. The TP note from 4.13 should have been part of 4.14 as well.


[id="virt-4-15-storage"]
=== Storage

//CNV-35029: PVC annotation to explain host-assisted cloning

[id="virt-4-15-web"]
=== Web console

//CNV-33122: Virtualization page updates for 4.15

//CNV-36165: VM disks with persistent reservation

//CNV-36162: Search option in VM configuration tab

//CNV-36159: New configuration option "SSH over NodePort service"

//CNV-36603: Mark bootable volumes as favorite
* When creating a VM from an instance type, you can now designate favorite bootable volumes by starring them in the volume list of the {product-title} web console.

//CNV-36464: Run a test that shows that the SR-IOV settings are correct

//CNV-34697: Instance types is now GA. Move the 4.14 RN from the TP section to here.

//CNV-33131: Set KSM from the UI
* You can enable or disable the xref:../../virt/virtual_machines/advanced_vm_management/virt-activating-ksm.adoc#virt-activating-ksm[kernel samepage merging (KSM) activation feature] for all cluster nodes by using the xref:../../virt/virtual_machines/advanced_vm_management/virt-activating-ksm.adoc#virt-configure-ksm-web_virt-activating-ksm[web console].

//CNV-33127: SR-IOV NIC hot plug from the UI

//CNV-31114: Using SSH key secret from another project
* You can now use existing secrets from other projects when xref:../../virt/virtual_machines/virt-accessing-vm-ssh.adoc#static-key-management-vm[adding a public SSH key during VM creation] or when xref:../../virt/virtual_machines/virt-edit-vms.adoc#virt-adding-secret-configmap-service-account-to-vm_virt-edit-vms[adding a secret to an existing VM].

//NOTE: Comment out deprecated and removed features (and their IDs) if not used in a release
[id="virt-4-15-deprecated-removed"]
== Deprecated and removed features


[id="virt-4-15-deprecated"]
=== Deprecated features
// NOTE: when uncommenting deprecated features list, change the Removed features header level below to ===

Deprecated features are included in the current release and supported. However, they will be removed in a future release and are not recommended for new deployments.

//CNV-26426 [DOCS] Release note: Deprecate TTO
* The `tekton-tasks-operator` is deprecated and Tekton tasks and example pipelines are now deployed by the `ssp-operator`.

//CNV-26316: Release note: Align tekton tasks with instancestypes
* The `copy-template`, `modify-vm-template`, and `create-vm-from-template` tasks are deprecated.

//CNV-29048 Release note: Metrics name changes
* Many OpenShift Virtualization metrics have changed or will change in a future version. These changes could affect your custom dashboards. See link:https://access.redhat.com/articles/7028805[OpenShift Virtualization 4.14 metric changes] for details. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2179660[*BZ#2179660*])

//CNV-32032 Release note: DEPRECATED FEATURE (Windows 2012R2 templates deprecated)
* Support for Windows Server 2012 R2 templates is deprecated.


[id="virt-4-15-removed"]
=== Removed features

Removed features are not supported in the current release.

//CNV-23499: Carry over/repeat removed feature from version 4.12 and 4.13
//Check if this is still needed for 4.15
* Support for the legacy HPP custom resource, and the associated storage class, has been removed for all new deployments. In {VirtProductName} {VirtVersion}, the HPP Operator uses the Kubernetes Container Storage Interface (CSI) driver to configure local storage. A legacy HPP custom resource is supported only if it had been installed on a previous version of {VirtProductName}.


[id="virt-4-15-technology-preview"]
== Technology Preview features

Some features in this release are currently in Technology Preview. These experimental features are not intended for production use. Note the following scope of support on the Red Hat Customer Portal for these features:

link:https://access.redhat.com/support/offerings/techpreview[Technology Preview Features Support Scope]

//CNV-27107 and CNV-28723
* You can now install and edit xref:../../virt/virtual_machines/creating_vms_rh/virt-creating-vms-from-instance-types.adoc#virt-creating-vm-instancetype_virt-creating-vms-from-instance-types[customized instance types] and preferences to create a VM from a volume or PersistentVolumeClaim (PVC).

//CNV-28944 Release note: Preview Cluster level eviction strategy change
* You can now configure a xref:../../virt/nodes/virt-node-maintenance.adoc#eviction-strategies[VM eviction strategy] for the xref:../../virt/nodes/virt-node-maintenance.adoc#virt-configuring-cluster-eviction-strategy-cli_virt-node-maintenance[entire cluster].

//CNV-15028: Nested virt in virt hosts. This feature will remain in tech preview indefinitely.
* You can now enable link:https://access.redhat.com/solutions/6692341[nested virtualization on {VirtProductName} hosts].

//CNV-29768: Memory hot plug

//CNV-29882: CPU hot plug

//CNV-33125: Add CPU limits to the UI


[id="virt-4-15-bug-fixes"]
== Bug fixes


[id="virt-4-15-known-issues"]
== Known issues

[discrete]
[id="virt-4-15-ki-monitoring"]
==== Monitoring
//4.14 Leave in per Stu (fix deferring to 4.15)
* The Pod Disruption Budget (PDB) prevents pod disruptions for migratable virtual machine images. If the PDB detects pod disruption, then `openshift-monitoring` sends a `PodDisruptionBudgetAtLimit` alert every 60 minutes for virtual machine images that use the `LiveMigrate` eviction strategy. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2026733[*BZ#2026733*])
** As a workaround, xref:../../monitoring/managing-alerts.adoc#silencing-alerts_managing-alerts[silence alerts].

[discrete]
[id="virt-4-15-ki-networking"]
==== Networking
//CNV-10590 - This issue can be removed for 4.15 when CNV-13680 RN is added.
//BZ-1885605
//4.14 leave in per Miguel Duarte de Mora Barroso
* If your {product-title} cluster uses OVN-Kubernetes as the default Container Network Interface (CNI) provider, you cannot attach a Linux bridge or bonding device to a host's default interface because of a change in the host network topology of OVN-Kubernetes. (link:https://bugzilla.redhat.com/show_bug.cgi?id=1885605[*BZ#1885605*])
** As a workaround, you can use a secondary network interface connected to your host, or switch to the OpenShift SDN default CNI provider.

//CNV-33789: Cannot SSH into VM over NodePort and Console's FQDN when using OVNKubernetes networking
* You cannot SSH into a VM when using the `networkType: OVNKubernetes` option in your `install-config.yaml` file. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2165895[*BZ#2165895*])

//4.14 leave in per Dan K
* You cannot run {VirtProductName} on a single-stack IPv6 cluster. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2193267[*BZ#2193267*])

[discrete]
[id="virt-4-15-ki-nodes"]
==== Nodes
//4.14 Leave in per Simone
* Uninstalling {VirtProductName} does not remove the `feature.node.kubevirt.io` node labels created by {VirtProductName}. You must remove the labels manually.
//(link:https://issues.redhat.com/browse/CNV-22036[*CNV-22036*])
//Commenting out the above link. The doc bug has a security level "Red Hat Employee". This is causing Travis build failure in the RN PR.

[discrete]
[id="virt-4-15-ki-storage"]
==== Storage
//4.14 Leave in per Adam
* In some instances, multiple virtual machines can mount the same PVC in read-write mode, which might result in data corruption. (link:https://bugzilla.redhat.com/show_bug.cgi?id=1992753[*BZ#1992753*])
** As a workaround, avoid using a single PVC in read-write mode with multiple VMs.

//4.14 Leave in per Adam and Stu; will be doc'd in 4.15
* If you clone more than 100 VMs using the `csi-clone` cloning strategy, then the Ceph CSI might not purge the clones. Manually deleting the clones might also fail. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2055595[*BZ#2055595*])
** As a workaround, you can restart the `ceph-mgr` to purge the VM clones.

//CNV-34198 (BZ 2237287)
* If you use Portworx as your storage solution on AWS and create a VM disk image, the created image might be smaller than expected due to the filesystem overhead being accounted for twice. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2237287[*BZ#2237287*])
** As a workaround, you can manually expand the Persistent Volume Claim (PVC) to increase the available space after the initial provisioning process completes.

//BZ2216038 from Ying
* If you simultaneously clone more than 1000 VMs using the provided DataSources in the `openshift-virtualization-os-images` namespace, it is possible that not all of the VMs will move to a running state. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2216038[*BZ#2216038*])
** As a workaround, deploy VMs in smaller batches.

//BZ2247593 from Ying
* Live migration cannot be enabled for a virtual machine instance (VMI) after a hotplug volume has been added and removed. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2055595[*BZ#2247593*])

[discrete]
[id="virt-4-15-ki-virtualization"]
==== Virtualization
//4.14 Leave in per Stu
* {VirtProductName} links a service account token in use by a pod to that specific pod. {VirtProductName} implements a service account volume by creating a disk image that contains a token. If you migrate a VM, then the service account volume becomes invalid. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2037611[*BZ#2037611*])
** As a workaround, use user accounts rather than service accounts because user account tokens are not bound to a specific pod.

// Leave in for 4.14 per Stu; remove from 4.15 RNs and move content to CNV docs, per Avital
* With the release of the link:https://access.redhat.com/errata/RHSA-2023:3722[RHSA-2023:3722] advisory, the TLS `Extended Master Secret` (EMS) extension (link:https://datatracker.ietf.org/doc/html/rfc7627[RFC 7627]) is mandatory for TLS 1.2 connections on FIPS-enabled RHEL 9 systems. This is in accordance with FIPS-140-3 requirements. TLS 1.3 is not affected. (link:https://bugzilla.redhat.com/show_bug.cgi?id=2157951[*BZ#2157951*])
+
Legacy OpenSSL clients that do not support EMS or TLS 1.3 now cannot connect to FIPS servers running on RHEL 9. Similarly, RHEL 9 clients in FIPS mode cannot connect to servers that only support TLS 1.2 without EMS. This in practice means that these clients cannot connect to servers on RHEL 6, RHEL 7 and non-RHEL legacy operating systems. This is because the legacy 1.0.x versions of OpenSSL do not support EMS or TLS 1.3. For more information, see link:https://access.redhat.com/solutions/7018256[TLS Extension "Extended Master Secret" enforced with Red Hat Enterprise Linux 9.2].

** As a workaround, upgrade legacy OpenSSL clients to a version that supports TLS 1.3 and configure {VirtProductName} to use TLS 1.3, with the `Modern` TLS security profile type, for FIPS mode.

[discrete]
[id="virt-4-15-ki-webconsole"]
==== Web console
//CNV-34771 from Ying
* If you upgrade {product-title} 4.13 to 4.14 without upgrading {VirtProductName}, the Virtualization pages of the web console crash. (link:https://bugzilla.redhat.com/show_bug.cgi?id=OCPBUGS-22853[*OCPBUGS-22853*])

** As a workaround, you must upgrade the {VirtProductName} Operator to 4.14 manually or set your subscription approval strategy to *Automatic*.