// Module included in the following assemblies:
//
// * operating/manage-role-based-access-control-3630.adoc
:_content-type: PROCEDURE
[id="declarative-configuration-resource-create_{context}"]
= Creating declarative configurations

Use `roxctl` to create the YAML files that store the configurations, create a config map from the files, and apply the config map.

.Prerequisites
* You have added the mount for the config map or secret during the installation of Central. In this example, the config map is called "declarative-configs". See the installation documentation listed in the "Additional resources" section for more information.

.Procedure

. Create the permission set by entering the following command. This example creates a permission set named "restricted" and is saved as the `permission-set.yaml` file. It sets read and write access for the `Administration` resource and read access to the Access resource.
+
[source,terminal,subs=attributes+]
----
$ roxctl declarative-config create permission-set \
--name="restricted" \
--description="Restriction permission set that only allows \
access to Administration and Access resources" \
--resource-with-access=Administration=READ_WRITE_ACCESS \
--resource-with-access=Access=READ_ACCESS > permission-set.yaml
----
. Create the role that allows access to the `Administration` and `Access` resources by entering the following command. This example creates a role named "restricted" and is saved as the `role.yaml` file.
+
[source,terminal,subs=attributes+]
----
$ roxctl declarative-config create role \
--name="restricted" \
--description="Restricted role that only allows access to Administration and Access" \
--permission-set="restricted" \
--access-scope="Unrestricted" > role.yaml
----
. Create a config map from the two YAML files that were created in the earlier steps by entering the following command. This example creates the `declarative-configurations` config map.
+
[source,terminal,subs=attributes+]
----
$ kubectl create configmap declarative-configurations \ <1>
--from-file permission-set.yaml --from-file role.yaml \
-o yaml --namespace=stackrox > declarative-configs.yaml
----
<1> For {ocp}, use `oc create`.
. Apply the config map by entering the following command:
+
[source,terminal,subs=attributes+]
----
$ kubectl apply -f declarative-configs.yaml <1>
----
<1> For {ocp}, use `oc apply`.
+
After you apply the config map, configuration information extracted from Central creates the resources.
+
[NOTE]
====
Although the watch interval is 5 seconds, as described in the following paragraph, there can be a delay in propagating changes from the config map to the Central mount.
====
You can configure the following intervals to specify how declarative configurations interact with Central:

* Configuration watch interval: The interval for Central to check for changes is every 5 seconds. You can configure this interval by using the `ROX_DECLARATIVE_CONFIG_WATCH_INTERVAL` environment variable.
* Reconciliation interval: By default, declarative configuration reconciliation with Central occurs every 20 seconds. You can configure this interval by using the `ROX_DECLARATIVE_CONFIG_RECONCILE_INTERVAL` environment variable.

After creating authentication and authorization resources by using declarative configuration, you can view them in the *Access Control* page in the {product-title-short} web portal. The *Origin* field indicates `Declarative` if the resource was created by using declarative configuration.

[NOTE]
====
You cannot edit resources created from declarative configurations in the {product-title-short} web portal. You must edit the configuration files directly to make changes to these resources.
====

You can view the status of declarative configurations by navigating to *Platform Configuration* -> *System Health* and scrolling to the *Declarative configuration* section.