// Module included in the following assemblies
//
// * functions/reference/serverless-developing-nodejs-functions.adoc

:_content-type: PROCEDURE
[id="serverless-nodejs-functions-overriding-liveness-readiness_{context}"]
= Overriding liveness and readiness probe values

You can override `liveness` and `readiness` probe values for your Node.js functions. This allows you to configure health checks performed on the function.

.Prerequisites

* The {ServerlessOperatorName} and Knative Serving are installed on the cluster.
* You have installed the Knative (`kn`) CLI.
* You have created a function by using `kn func create`.

.Procedure

. In your function code, create the `Function` object, which implements the following interface:
+
[source,javascript]
----
export interface Function {
  init?: () => any; <1>

  shutdown?: () => any; <2>

  liveness?: HealthCheck; <3>

  readiness?: HealthCheck; <4>

  logLevel?: LogLevel;

  handle: CloudEventFunction | HTTPFunction; <5>
}
----
<1> The initialization function, called before the server is started. This function is optional and should be synchronous.
<2> The shutdown function, called after the server is stopped. This function is optional and should be synchronous.
<3> The liveness function, called to check if the server is alive. This function is optional and should return 200/OK if the server is alive.
<4> The readiness function, called to check if the server is ready to accept requests. This function is optional and should return 200/OK if the server is ready.
<5> The function to handle HTTP requests.
+
For example, add the following code to the `index.js` file:
+
[source,javascript]
----
const Function = {

  handle: (context, body) => {
    // The function logic goes here
    return 'function called'
  },

  liveness: () => {
    process.stdout.write('In liveness\n');
    return 'ok, alive';
  }, <1>

  readiness: () => {
    process.stdout.write('In readiness\n');
    return 'ok, ready';
  } <2>
};

Function.liveness.path = '/alive'; <3>
Function.readiness.path = '/ready'; <4>

module.exports = Function;
----
<1> Custom `liveness` function.
<2> Custom `readiness` function.
<3> Custom `liveness` endpoint.
<4> Custom `readiness` endpoint.
+
As an alternative to `Function.liveness.path` and `Function.readiness.path`, you can specify custom endpoints using the `LIVENESS_URL` and `READINESS_URL` environment variables:
+
[source,yaml]
----
run:
  envs:
  - name: LIVENESS_URL
    value: /alive <1>
  - name: READINESS_URL
    value: /ready <2>
----
<1> The liveness path, set to `/alive` here.
<2> The readiness path, set to `/ready` here.

. Add the new endpoints to the `func.yaml` file, so that they are properly bound to the container for the Knative service:
+
[source,yaml]
----
deploy:
  healthEndpoints:
    liveness: /alive
    readiness: /ready
----
