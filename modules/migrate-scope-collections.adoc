// Module included in the following assemblies:
//
// * operating/create-use-collections.adoc
:_content-type: CONCEPT
[id="migrate-scope-collections_{context}"]
= Migration of access scopes to collections

Database changes in {product-title-short} from `rocksdb` to PostgreSQL are provided as a Technology Preview beginning with release 3.74 and are generally available in release 4.0. When the database is migrated from `rocksdb` to PostgreSQL, existing access scopes used in vulnerability reporting are migrated to collections. You can verify that the migration resulted in the correct configuration for your existing reports by navigating to *Vulnerability Management* -> *Reporting* and viewing the report information.

The migration process creates collection objects for access scopes that were used in report configurations. {product-title-short} generates two or more collections for a single access scope, depending on the complexity of the access scope. The generated collections for a given access scope include the following types:

* Embedded collections: To mimic the exact selection logic of the original access scope, {product-title-short} generates one or more collections where matched deployments result in the same selection of clusters and namespaces as the original access scope. The collection name is in the format of `System-generated embedded collection _number_ for the scope` where _number_ is a number starting from 0.
+
[NOTE]
====
These embedded collections will not have any attached collections. They have cluster and namespace selection rules, but no deployment rules because the original access scopes did not filter on deployments.
====
* Root collection for the access scope: This collection is added to the report configurations. The collection name is in the format of `System-generated root collection for the scope`. This collection does not define any rules, but attaches one or more embedded collections. The combination of these embedded collections results in the same selection of clusters and namespaces as the original access scope.

For access scopes that define cluster or namespace label selectors, {product-title-short} can only migrate those scopes that have the 'IN' operator between the key and values. Access scopes with label selectors that were created by using the {product-title-short} portal used the 'IN' operator by default. Migration of scopes that used the 'NOT_IN', 'EXISTS' and 'NOT_EXISTS' operators is not supported. If a collection cannot be created for an access scope, log messages are created during the migration. Log messages have the following format:

----
Failed to create collections for scope _scope-name_: Unsupported operator NOT_IN in scope's label selectors. Only operator 'IN' is supported.
The scope is attached to the following report configurations: [list of report configs]; Please manually create an equivalent collection and edit the listed report configurations to use this collection. Note that reports will not function correctly until a collection is attached.
----

You can also click the report in *Vulnerability Management* -> *Reporting* to view the report information page. This page contains a message if a report needs a collection attached to it.

[NOTE]
====
The original access scopes are not removed during the migration. If you created an access scope only for use in filtering vulnerability management reports, you can manually remove the access scope.
====
