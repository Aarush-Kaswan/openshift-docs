// Module included in the following assemblies:
//

:_mod-docs-content-type: PROCEDURE
[id="serverless-logic-asyncAPI-consuming-event_{context}"]
= Consuming an event

To enable seamless event consumption, define the Kafka server, subscription channel, and a function that consumes the event, and then invoke the function in your workflow. When your workflow reaches the function, it pauses and waits for the specific event from the Kafka topic before continuing.

.Prerequisites
* You have created a {ServerlessLogicProductName} project or have access to a project with the appropriate roles and permissions to create applications and other workloads in {ocp-product-title}.
* You have created your {ServerlessLogicProductName} project.
* You have created the `asyncAPI.yaml` file and your project `classpath`.
* Your project includes necessary dependencies for AsyncAPI and Kafka.

.Procedure

. Define the Kafka Server in your `asyncAPI.yaml` file as shown in the following example:
+
[source,yaml]
----
servers:
  development:
    url: localhost:9092
    description: Development server
    protocol: kafka
    protocolVersion: '1.0.0'
----

. Create a subscription channel in the `asyncAPI.yaml` file. 
+
The following example shows to define a subscription channel named `wait`:
+
[source,yaml]
----
channels:
  wait:
    description: A message channel
    subscribe:
      operationId: consumeWait
      summary: Get messages
      message:
        $ref: '#/components/messages/message'
----

. Add a function in your workflow that uses the `asyncapi` type and points to the `consumeWait` operation ID.
+
[source,json]
----
{
  "functions": [
    {
      "name": "consumeEvent",
      "type": "asyncapi",
      "operation": "asyncAPI.yaml#consumeWait"
    }
  ]
}
----
+
[NOTE]
====
The `operation` property supports `http`, `https`, and `file` schemas for the URI. If no schema is specified, it assumes the file is on the project classpath.
====

. In your workflow, invoke the `consumeEvent` function within an operation state:
+
.Example of invoking the function
[source,json]
----
{
  "states": [
    {
      "name": "waitForEvent",
      "type": "operation",
      "actions": [
        {
          "functionRef": "consumeEvent"
        }
      ]
    }
  ]
}
----

. Execute the workflow. 
+
When the workflow reaches the `waitForEvent` state, it pauses.